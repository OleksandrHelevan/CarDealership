-- PostgreSQL schema for CarDealership entities
-- Generated from CarDealership/entity and DealershipContext configuration

-- Engines
CREATE TABLE gasoline_engines (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    power DOUBLE PRECISION NOT NULL,
    fuel_type TEXT NOT NULL,
    fuel_consumption REAL NOT NULL
);

CREATE TABLE electro_engines (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    power DOUBLE PRECISION NOT NULL,
    battery_capacity DOUBLE PRECISION NOT NULL,
    range INTEGER NOT NULL,
    motor_type TEXT NOT NULL
);

-- Cars
CREATE TABLE gasoline_cars (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    brand VARCHAR(100) NOT NULL,
    model_name VARCHAR(100) NOT NULL,
    engine_id INTEGER NOT NULL REFERENCES gasoline_engines(id),
    color TEXT NOT NULL,
    mileage INTEGER NOT NULL,
    price DOUBLE PRECISION NOT NULL,
    weight INTEGER NOT NULL,
    drive_type TEXT NOT NULL,
    transmission TEXT NOT NULL,
    year INTEGER NOT NULL,
    number_of_doors INTEGER NOT NULL,
    body_type TEXT NOT NULL
);

CREATE TABLE electro_cars (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    brand VARCHAR(100) NOT NULL,
    model_name VARCHAR(100) NOT NULL,
    engine_id INTEGER NOT NULL REFERENCES electro_engines(id),
    color TEXT NOT NULL,
    mileage INTEGER NOT NULL,
    price DOUBLE PRECISION NOT NULL,
    weight INTEGER NOT NULL,
    drive_type TEXT NOT NULL,
    transmission TEXT NOT NULL,
    year INTEGER NOT NULL,
    number_of_doors INTEGER NOT NULL,
    body_type TEXT NOT NULL
);

-- Products
CREATE TABLE products (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    number TEXT NOT NULL,
    country_of_origin TEXT NOT NULL,
    in_stock BOOLEAN NOT NULL,
    available_from TIMESTAMP NULL,
    electro_car_id INTEGER NULL REFERENCES electro_cars(id),
    gasoline_car_id INTEGER NULL REFERENCES gasoline_cars(id)
);

-- Identity and clients
CREATE TABLE passport_data (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    first_name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    passport_number TEXT NOT NULL
);

CREATE TABLE keys (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    login VARCHAR(100) NOT NULL,
    password VARCHAR(100) NOT NULL,
    access_right TEXT NOT NULL
);

CREATE TABLE clients (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES keys(id),
    passport_data_id INTEGER NOT NULL REFERENCES passport_data(id)
);

-- Orders
CREATE TABLE orders (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    client_id INTEGER NOT NULL REFERENCES clients(id) ON DELETE RESTRICT,
    product_id INTEGER NOT NULL REFERENCES products(id) ON DELETE RESTRICT,
    order_date TIMESTAMP NOT NULL,
    payment_type TEXT NOT NULL,
    delivery BOOLEAN NOT NULL
);

-- Authorization requests
CREATE TABLE requests (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    login VARCHAR(100) NOT NULL,
    status TEXT NOT NULL
);

